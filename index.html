<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chemin de Fer Interactif - Réunion Annuelle GBH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f5f7;
        }
        .editable, .editable-title {
            padding: 6px 8px;
            border-radius: 4px;
            transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .editable {
            min-height: 40px;
        }
        .editable:focus, .editable-title:focus {
            background-color: #ffffff;
            outline: none;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
        .timecode-link {
            display: inline-block;
            margin: 2px;
            padding: 4px 8px;
            background-color: #e0e7ff;
            color: #3730a3;
            border-radius: 9999px;
            font-size: 0.8rem;
            font-weight: 500;
            text-decoration: none;
            transition: background-color 0.2s ease;
        }
        .timecode-link:hover {
            background-color: #c7d2fe;
            color: #312e81;
        }
        details[open] summary ~ * {
            animation: sweep .5s ease-in-out;
        }
        @keyframes sweep {
            0%    {opacity: 0; transform: translateY(-10px)}
            100%  {opacity: 1; transform: translateY(0)}
        }
        .header-grid {
             display: grid;
             grid-template-columns: 50px 1fr 80px 1.5fr 1.5fr 1.5fr 1.5fr 50px;
             gap: 0.75rem;
             align-items: center;
        }
        .sequence-grid {
            display: grid;
            grid-template-columns: 50px 1fr 80px 1.5fr 1.5fr 1.5fr 1.5fr 50px;
            gap: 0.75rem;
            align-items: start;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        @media (max-width: 1024px) {
            .header-grid, .sequence-grid {
                grid-template-columns: 1fr;
            }
            .header-grid > div {
                display: none;
            }
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <div class="bg-white p-6 rounded-2xl shadow-lg mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-900">Chemin de Fer Interactif</h1>
            <p class="text-gray-600 mt-2">Film : Réunion Annuelle La Réunion</p>
            <div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm text-blue-800">
                <p><span class="font-bold">Instructions :</span> Tous les champs sont modifiables. Cliquez sur un texte pour le changer. Les modifications sont sauvegardées dans votre navigateur lorsque vous cliquez sur "Sauvegarder".</p>
            </div>
             <div class="mt-6 flex flex-wrap gap-4">
                <button id="save-btn" class="px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transition-colors duration-200">
                    Sauvegarder
                </button>
            </div>
        </div>

        <div id="sequences-container" class="space-y-6">
            <!-- Les sections et séquences seront injectées ici par JavaScript -->
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const defaultData = [
            {
                section: "Entreprendre pour la solidarité",
                open: true,
                sequences: [
                    { id: 'solidarite-1', theme: "Réponse à la Crise & Soutien Logistique", duration: "1'00\"", visual: "Images de la crise Covid (stylisées). Plans des entrepôts de la Banque Alimentaire, bénévoles en action. Focus sur les conteneurs de denrées.", audio: "VO (Montage de discours): \"Au mois de mars 2020, la crise du qu'Ovide se déclenche... L'attitude de nos collaborateurs est exemplaire.\" + \"Nous réussissons à importer... 1 350 000 masques.\"", message: "En temps de crise, le groupe est un pilier de la société, capable de mobiliser sa puissance logistique pour le bien commun.", timecodes: "Soirée des collaborateurs (longue): 01:08-01:14 (crise du qu'Ovide...) | Soirée des collaborateurs (longue): 01:57-02:13 (1 350 000 masques)" },
                    { id: 'solidarite-2', theme: "Le Partenariat avec la Banque Alimentaire", duration: "1'15\"", visual: "Extraits de la vidéo sur la Banque Alimentaire. Plans du camion-cuisine en action, ateliers culinaires, distribution. Témoignage d'un responsable de la BA.", audio: "Témoignage (Banque Alimentaire): \"C'est pas seulement un partenaire sur le transport maritime mais c'est également un partenaire dans le mécénat financier... et sur la ramasse à travers la filiale Carrefour.\" + Focus sur le camion-cuisine et son rôle nutritionnel.", message: "La solidarité de GBH est un engagement profond, multiforme (logistique, financier, dons) et innovant, qui s'attaque aux causes profondes des problèmes sociaux.", timecodes: "Vidéo Banque Alimentaire (01hK7efHWio): 00:50-01:05 (soutien multiforme) | Vidéo Banque Alimentaire (01hK7efHWio): 01:23-01:37 (camion-cuisine)" }
                ]
            },
            {
                section: "Entreprendre pour l'emploi",
                open: false,
                sequences: [
                    { id: 'emploi-1', theme: "Tremplin pour l'Emploi : Donner une Chance", duration: "1'00\"", visual: "Images des programmes TPE avec le RSMA et l'E2C. Jeunes en formation (militaire, mécanique, vente). Témoignages d'Anaïs Regnault ou Cécile Cavalie.", audio: "Témoignage (RRH ou M. Lapeyre): \"Tremplin pour l'emploi... s'adresse à des jeunes éloignés de l'emploi... l'ambition de recruter 15 jeunes en vue de préparer un titre professionnel...\" + Focus sur le \"savoir-être\".", message: "GBH investit dans la jeunesse en difficulté, en lui offrant non seulement des compétences techniques mais aussi les codes du monde professionnel.", timecodes: "Vidéo TPE RSMA (Oi-JXBtkNp4): 00:05-00:25 (présentation) | Vidéo TPE Département (oN_rl4x6WDw): 00:06-00:16 (partenariat)" },
                    { id: 'emploi-2', theme: "Construire les Carrières : DistriSup & EGC", duration: "0'45\"", visual: "Extraits des vidéos sur DistriSup et l'EGC. Étudiants en alternance, en stage. Témoignage d'Amaury de Lavigne.", audio: "Témoignage (A. de Lavigne): \"Nous avons 30% de nos cadres qui sont issus de ce cursus de formation.\" + \"100% des jeunes qui ont suivi ce parcours... sont aujourd'hui des jeunes à responsabilité dans l'entreprise.\"", message: "GBH forme ses propres managers de demain en partenariat avec les meilleures écoles locales, garantissant un pipeline de talents.", timecodes: "Vidéo DistriSup (Y-pek71Eh3c): 00:37-00:42 (30% cadres) | Vidéo EGC (kBI5in_XnqI): 00:57-01:01 (103 stagiaires)" },
                    { id: 'emploi-3', theme: "Le Témoignage Collaborateur : L'Évolution Interne", duration: "0'45\"", visual: "Portrait de Sullivan Bousleiman dans son magasin Carrefour. Interaction avec ses équipes.", audio: "Témoignage (S. Bousleiman): \"Mon parcours a débuté en tant que directeur adjoint, puis j'ai été promu directeur...\" + \"J'ai trouvé dans GBH une autonomie et une liberté d'entreprendre qui sont mes maîtres mots au quotidien.\"", message: "Le groupe offre de réelles perspectives d'évolution et une culture d'entreprise qui valorise l'autonomie et l'initiative.", timecodes: "Vidéo Sullivan (AlHd-BrAGPQ): 00:22-00:33 (parcours) | Vidéo Sullivan (AlHd-BrAGPQ): 00:44-00:51 (autonomie)" }
                ]
            },
            {
                section: "Entreprendre pour la production locale",
                open: false,
                sequences: [
                    { id: 'prodlocale-1', theme: "Un Partenariat Stratégique avec la Terre", duration: "1'30\"", visual: "Montage de magnifiques images issues de jechoisislareunion.re. Paysages agricoles, gros plans sur les produits, portraits souriants des producteurs (famille Mussard, Annie Waro, etc.).", audio: "VO (Discours): \"Aujourd'hui, plus de 30 % de notre chiffre d'affaires est réalisé avec la production locale de la réunion. Cela fait de notre groupe l'acteur le plus engagé dans ce domaine.\" + SOUNDBITES de producteurs : \"Très fier de mon métier, j'aime bien ce que je fais.\"", message: "L'engagement pour le local n'est pas un slogan, mais une stratégie économique fondamentale qui crée une valeur partagée entre le groupe, les producteurs et les consommateurs.", timecodes: "Soirée collaborateurs (longue): 04:08-04:20 (30%) | jechoisislareunion.re: (plans esthétiques)" }
                ]
            },
            {
                section: "Entreprendre pour le développement durable",
                open: false,
                sequences: [
                    { id: 'devdurable-1', theme: "Le Recyclage des Cintres : Une Solution Innovante", duration: "1'00\"", visual: "Plans tirés de la vidéo de David Payet. 1. Le problème (tas de cintres). 2. Le processus (broyage). 3. La solution (pots horticoles finis en rayon chez Mr. Bricolage).", audio: "Témoignage (D. Payet): \"Le contexte insulaire de notre territoire complexifie la gestion de nos déchets.\" + \"Nous avons trouvé un partenaire à la Réunion... pour recycler ces cintres... et fabriquer des pots horticoles.\"", message: "Face aux contraintes de l'île, le groupe innove en créant des boucles d'économie circulaire qui bénéficient à l'environnement et à l'économie locale.", timecodes: "Vidéo Recyclage Cintres (n3_LaCVxTE4): 00:06-00:12 (contexte) | Vidéo Recyclage Cintres (n3_LaCVxTE4): 00:19-00:37 (processus)" }
                ]
            },
            {
                section: "Entreprendre pour le patrimoine",
                open: false,
                sequences: [
                    { id: 'patrimoine-1', theme: "Un Gardien de la Culture", duration: "0'45\"", visual: "Images de l'événement de lancement du livre \"Patrimoine de La Réunion\" au musée Stella Matutina. Plans sur l'ouvrage, l'audience, les intervenants.", audio: "VO (B. Hayot): \"Ma conviction est que les entreprises doivent s'engager dans l'action culturelle, dans les territoires où elles sont installées.\"", message: "Le rôle du groupe transcende l'économie pour devenir celui d'un acteur engagé dans la préservation et la transmission de l'identité culturelle de l'île.", timecodes: "Présentation Ouvrage Patrimoine: 23:10-23:45 (Conviction)" },
                    { id: 'patrimoine-2', theme: "Conclusion : L'Horizon et l'Avenir", duration: "0'45\"", visual: "Montage final majestueux : paysages grandioses de La Réunion (pitons, cirques), mêlés à des ralentis sur les visages des collaborateurs et partenaires vus dans le film. Plan final sur un lever de soleil.", audio: "VO (B. Hayot): \"Respecter le patrimoine, c'est respecter son pays. C'est agir pour l'avenir.\" + \"Si nous restons fidèles à tous ces principes... alors nous pouvons regarder l'avenir avec confiance.\"", message: "Chaque action du groupe, guidée par ses valeurs, est un investissement dans l'avenir de La Réunion, préservant son passé tout en construisant son futur.", timecodes: "Présentation Ouvrage Patrimoine: 24:25-24:40 (Respect) | Soirée collaborateurs (courte): 04:58-05:10 (Avenir)" }
                ]
            }
        ];

        let sequencesData = [];
        const container = document.getElementById('sequences-container');
        const storageKey = 'cheminDeFerData';

        const savedData = localStorage.getItem(storageKey);
        if (savedData) {
            try {
                sequencesData = JSON.parse(savedData);
            } catch (e) {
                console.error("Error parsing saved data, using default.", e);
                sequencesData = defaultData;
            }
        } else {
            sequencesData = defaultData;
        }

        const render = () => {
            container.innerHTML = '';
            sequencesData.forEach((sectionData, sectionIndex) => {
                const sectionElement = document.createElement('div');
                sectionElement.className = 'bg-white rounded-2xl shadow-lg';
                sectionElement.innerHTML = `
                    <details ${sectionData.open ? 'open' : ''}>
                        <summary class="p-4 md:p-6 cursor-pointer flex justify-between items-center">
                            <h2 class="editable-title text-xl md:text-2xl font-bold text-gray-800" contenteditable="true" data-section-index="${sectionIndex}">${sectionData.section}</h2>
                            <div class="text-blue-600 transform transition-transform duration-300">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </summary>
                        <div class="px-4 md:px-6 pb-4">
                            <div class="header-grid font-semibold text-gray-500 text-sm uppercase tracking-wider p-4 hidden md:grid">
                                <div>SEQ</div>
                                <div>Thème / Titre</div>
                                <div>Durée</div>
                                <div>Plan Visuel</div>
                                <div>Plan Sonore</div>
                                <div>Message Clé</div>
                                <div>Timecodes & Sources</div>
                                <div></div>
                            </div>
                            <div id="section-content-${sectionIndex}"></div>
                            <div class="mt-4">
                                <button data-section-index="${sectionIndex}" class="add-sequence-btn px-4 py-2 bg-green-100 text-green-800 font-semibold rounded-lg hover:bg-green-200 text-sm">
                                    + Ajouter une séquence
                                </button>
                            </div>
                        </div>
                    </details>
                `;
                container.appendChild(sectionElement);
                const sectionContent = document.getElementById(`section-content-${sectionIndex}`);
                
                if (sectionData.sequences) {
                    sectionData.sequences.forEach((seq, seqIndex) => {
                        const seqElement = document.createElement('div');
                        seqElement.className = 'sequence-grid';
                        seqElement.innerHTML = `
                            <div class="font-bold text-gray-700 text-center p-2">${sectionIndex + 1}.${seqIndex + 1}</div>
                            <div class="editable bg-gray-50 hover:bg-gray-100" contenteditable="true" data-section="${sectionIndex}" data-seq="${seqIndex}" data-field="theme">${seq.theme || ''}</div>
                            <div class="editable bg-gray-50 hover:bg-gray-100" contenteditable="true" data-section="${sectionIndex}" data-seq="${seqIndex}" data-field="duration">${seq.duration || ''}</div>
                            <div class="editable bg-gray-50 hover:bg-gray-100" contenteditable="true" data-section="${sectionIndex}" data-seq="${seqIndex}" data-field="visual">${seq.visual || ''}</div>
                            <div class="editable bg-gray-50 hover:bg-gray-100" contenteditable="true" data-section="${sectionIndex}" data-seq="${seqIndex}" data-field="audio">${seq.audio || ''}</div>
                            <div class="editable bg-gray-50 hover:bg-gray-100" contenteditable="true" data-section="${sectionIndex}" data-seq="${seqIndex}" data-field="message">${seq.message || ''}</div>
                            <div class="editable bg-gray-50 hover:bg-gray-100" contenteditable="true" data-section="${sectionIndex}" data-seq="${seqIndex}" data-field="timecodes">${seq.timecodes || ''}</div>
                            <div class="text-center">
                                <button data-section="${sectionIndex}" data-seq="${seqIndex}" class="delete-sequence-btn p-2 text-gray-400 hover:text-red-600 rounded-full">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>
                                </button>
                            </div>
                        `;
                        sectionContent.appendChild(seqElement);
                    });
                }
            });
            attachEventListeners();
        };
        
        const attachEventListeners = () => {
             document.querySelectorAll('.editable').forEach(el => {
                el.addEventListener('blur', (e) => {
                    const { section, seq, field } = e.target.dataset;
                    sequencesData[section].sequences[seq][field] = e.target.innerText;
                });
            });

            document.querySelectorAll('.editable-title').forEach(el => {
                el.addEventListener('blur', (e) => {
                    const { sectionIndex } = e.target.dataset;
                    sequencesData[sectionIndex].section = e.target.innerText;
                });
            });

            document.querySelectorAll('.add-sequence-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const { sectionIndex } = e.target.dataset;
                    if (!sequencesData[sectionIndex].sequences) {
                        sequencesData[sectionIndex].sequences = [];
                    }
                    sequencesData[sectionIndex].sequences.push({
                        id: `new-${Date.now()}`,
                        theme: "Nouveau Thème",
                        duration: "0'00\"",
                        visual: "Description visuelle",
                        audio: "Description sonore",
                        message: "Message clé",
                        timecodes: "Source (ID): 00:00-00:00"
                    });
                    render();
                });
            });

            document.querySelectorAll('.delete-sequence-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const { section, seq } = e.currentTarget.dataset;
                    if(confirm('Êtes-vous sûr de vouloir supprimer cette séquence ?')) {
                        sequencesData[section].sequences.splice(seq, 1);
                        render();
                    }
                });
            });
        };

        document.getElementById('save-btn').addEventListener('click', () => {
            const saveButton = document.getElementById('save-btn');
            try {
                localStorage.setItem(storageKey, JSON.stringify(sequencesData));
                saveButton.textContent = 'Sauvegardé !';
                saveButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                saveButton.classList.add('bg-green-500');

                setTimeout(() => {
                    saveButton.textContent = 'Sauvegarder';
                    saveButton.classList.remove('bg-green-500');
                    saveButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
                }, 2000);

            } catch (error) {
                console.error("Failed to save to localStorage", error);
                alert("Erreur lors de la sauvegarde. L'espace de stockage local est peut-être plein.");
            }
        });

        render();
    });
    </script>
</body>
</html>
